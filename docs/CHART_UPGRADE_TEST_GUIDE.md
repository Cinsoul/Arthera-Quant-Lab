# 🧪 图表升级测试指南

**日期：** 2024-12-09

---

## 🎯 快速测试流程

### 测试1：查看"Full chart"按钮

```
步骤：
1. 打开应用
2. 导航到 chart-view 或 Dashboard点击任意股票
3. 进入ChartWorkbench
4. 查看右上角工具栏

预期结果：
✅ 看到蓝色的"Full chart"按钮（带Maximize图标）
✅ 按钮位于刷新/导出按钮之后，设置按钮之前
✅ Hover时颜色变深（#0284c7）
```

---

### 测试2：打开全屏图表

```
步骤：
1. 在ChartWorkbench
2. 点击"Full chart"按钮

预期结果：
✅ 全屏图表立即显示（覆盖整个视口）
✅ 顶部显示完整工具栏
✅ 左侧显示9个绘图工具
✅ 中央显示K线图
✅ 底部显示统计栏
✅ 背景深蓝色（#0a1628）
```

---

### 测试3：顶部工具栏

```
测试项：
1. 股票选择器
   - 点击下拉菜单
   - 选择"宁德时代"
   - 图表切换到300750

2. 图表类型切换
   - 点击"线图"图标
   - 图表类型改变

3. 时间周期
   - 点击"5"（5分钟）
   - 图表数据点增多

预期结果：
✅ 所有下拉菜单/按钮正常响应
✅ 图表实时更新
✅ 激活状态正确显示（蓝色背景）
```

---

### 测试4：左侧绘图工具

```
测试项：
1. 点击"趋势线"工具
   - 工具高亮（蓝色）
   - 底部显示"活跃工具: 趋势线"

2. 点击"十字光标"
   - 之前的工具取消激活
   - 新工具激活

3. 点击"删除"工具（红色）
   - 工具显示红色Hover效果

预期结果：
✅ 工具激活状态正确
✅ 只有一个工具同时激活
✅ 底部统计栏实时更新
```

---

### 测试5：关闭全屏

```
方式1：按ESC键
步骤：按下ESC键

方式2：点击X按钮
步骤：点击右上角X按钮

预期结果：
✅ 全屏图表立即关闭
✅ 返回ChartWorkbench
✅ 状态保持（股票/周期/工具）
```

---

### 测试6：状态持久化

```
步骤：
1. 打开全屏图表
2. 选择股票"比亚迪"（002594）
3. 选择周期"15分钟"
4. 激活"矩形"工具
5. 关闭全屏
6. 刷新页面（F5）
7. 重新打开全屏图表

预期结果：
✅ 股票仍是"比亚迪"
✅ 周期仍是"15分钟"
✅ （工具状态可能重置为默认）
```

---

## 📊 视觉检查清单

### 顶部工具栏
- [ ] 高度48px，深蓝色背景
- [ ] 股票选择器宽度200px
- [ ] 图表类型按钮4个，紧凑排列
- [ ] 时间周期按钮8个，横向排列
- [ ] 右侧工具按钮对齐
- [ ] X按钮红色Hover效果

### 左侧工具栏
- [ ] 宽度48px，深蓝色背景
- [ ] 工具按钮40x40px
- [ ] 工具图标5x5（w-5 h-5）
- [ ] 激活状态蓝色背景
- [ ] Hover灰色背景
- [ ] 分隔线正确显示

### 图表区域
- [ ] 占据剩余空间
- [ ] 16px内边距
- [ ] 圆角边框
- [ ] K线图完整显示
- [ ] 实时数据更新（LIVE指示器闪烁）

### 底部统计栏
- [ ] 高度48px
- [ ] 文字12px（text-xs）
- [ ] 左右布局（justify-between）
- [ ] 实时指示器绿色脉冲

---

## 🐛 常见问题排查

### 问题1："Full chart"按钮不显示
```
检查：
1. ChartWorkbench组件是否导入FullChartView
2. useChartService Hook是否正确调用
3. 按钮代码是否存在

解决：确认所有导入路径正确
```

### 问题2：点击按钮无响应
```
检查：
1. onClick事件是否绑定
2. setServiceSymbol是否调用
3. setShowFullChart是否更新

解决：检查状态更新逻辑
```

### 问题3：全屏图表不显示
```
检查：
1. showFullChart状态是否为true
2. FullChartView组件是否渲染
3. z-index是否足够高（应为100）

解决：检查条件渲染 {showFullChart && ...}
```

### 问题4：工具激活不生效
```
检查：
1. ChartService是否正确初始化
2. setActiveTool是否调用
3. state.activeTool是否更新

解决：检查ChartService订阅机制
```

### 问题5：状态不持久化
```
检查：
1. LocalStorage是否可用
2. saveToLocalStorage是否调用
3. 浏览器隐私模式是否开启

解决：检查notify()方法调用
```

---

## 🎨 手动测试场景

### 场景1：完整工作流
```
1. 打开应用 → Dashboard
2. 点击"贵州茅台"卡片 → 进入chart-view
3. 点击"Full chart"按钮 → 全屏图表
4. 选择"宁德时代" → 图表更新
5. 切换到"5分钟" → 数据点增多
6. 激活"趋势线"工具 → 工具高亮
7. 按ESC → 返回ChartWorkbench

预期：所有步骤流畅，无卡顿或错误
```

### 场景2：多次切换
```
1. 打开全屏图表
2. 关闭
3. 重新打开
4. 切换股票
5. 关闭
6. 再次打开

预期：每次打开/关闭都正常，状态正确保存
```

### 场景3：快速操作
```
1. 快速点击多个工具
2. 快速切换时间周期
3. 快速切换股票

预期：UI响应迅速，无延迟或闪烁
```

---

## 📸 屏幕截图对比

### 预期效果（参考图片1）

```
[图1：ChartWorkbench with "Full chart" button]

特征：
- 右上角蓝色"Full chart"按钮
- 按钮文字清晰
- Maximize图标显示
```

### 预期效果（参考图片2）

```
[图2：FullChartView - TradingView风格]

特征：
- 顶部完整工具栏
- 左侧9个绘图工具
- 中央K线图完整
- 底部统计栏
- 全屏覆盖（无其他UI）
```

---

## ✅ 测试通过标准

### 功能测试
- [x] "Full chart"按钮显示
- [x] 点击打开全屏图表
- [x] 全屏图表布局正确
- [x] 顶部工具栏功能正常
- [x] 左侧工具栏激活正确
- [x] 图表显示完整
- [x] ESC/X关闭正常
- [x] 状态持久化

### 视觉测试
- [x] 颜色符合设计
- [x] 尺寸布局正确
- [x] 字体大小合适
- [x] 间距padding正确
- [x] Hover效果流畅
- [x] 激活状态清晰

### 性能测试
- [x] 打开速度<100ms
- [x] 工具切换<50ms
- [x] 无明显卡顿
- [x] 内存占用正常

---

## 🚀 快速验证命令

### 1. 检查文件是否存在
```bash
ls -la services/ChartService.ts
ls -la components/FullChartView.tsx
```

### 2. 检查导入是否正确
```bash
grep -r "import.*FullChartView" components/
grep -r "import.*ChartService" components/
```

### 3. 检查TypeScript编译
```bash
# 如果有tsc
tsc --noEmit
```

---

## 📝 测试报告模板

```
测试日期：2024-12-09
测试人员：[你的名字]
测试环境：Chrome/Firefox/Safari

【测试1】Full chart按钮显示
状态：✅ 通过 / ❌ 失败
备注：

【测试2】打开全屏图表
状态：✅ 通过 / ❌ 失败
备注：

【测试3】顶部工具栏
状态：✅ 通过 / ❌ 失败
备注：

【测试4】左侧绘图工具
状态：✅ 通过 / ❌ 失败
备注：

【测试5】关闭全屏
状态：✅ 通过 / ❌ 失败
备注：

【测试6】状态持久化
状态：✅ 通过 / ❌ 失败
备注：

【总体评价】
功能完整度：___/100
视觉还原度：___/100
性能表现：___/100
用户体验：___/100

综合评分：___/100
```

---

## 🎯 测试优先级

### P0（必须测试）
1. ✅ "Full chart"按钮显示
2. ✅ 点击打开全屏
3. ✅ ESC/X关闭
4. ✅ 图表正常显示

### P1（重要）
1. ✅ 工具栏所有按钮
2. ✅ 绘图工具激活
3. ✅ 股票/周期切换

### P2（次要）
1. ✅ 状态持久化
2. ✅ Hover效果
3. ✅ 动画流畅度

---

**测试指南版本：** v1.0  
**创建日期：** 2024-12-09  
**更新日期：** 2024-12-09

---

# 🎉 准备就绪，开始测试！

按照以上流程逐项测试，确保所有功能正常工作！✅
